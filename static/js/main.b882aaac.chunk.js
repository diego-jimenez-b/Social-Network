(this["webpackJsonpsocial-project"]=this["webpackJsonpsocial-project"]||[]).push([[0],{24:function(e,t,n){e.exports={background:"AuthForm_background__3KrZm","form-container":"AuthForm_form-container__3kXpV",btn:"AuthForm_btn___5j8H",actions:"AuthForm_actions__3qWgF",text:"AuthForm_text__3Ob4_","user-info":"AuthForm_user-info__QQ4Hw",message:"AuthForm_message__OzCiQ",red:"AuthForm_red__2YH1F",error:"AuthForm_error__1yo3n"}},28:function(e,t,n){e.exports={info:"UserInfo_info__3uMdi","profile-img":"UserInfo_profile-img__2exm5","config-icon":"UserInfo_config-icon__UFzB1",config:"UserInfo_config__1XSIr","action-btns":"UserInfo_action-btns__2pn0q",message:"UserInfo_message__3RRz1"}},32:function(e,t,n){e.exports={post:"PostItem_post__3yOne",actions:"PostItem_actions__2EhW0","user-info":"PostItem_user-info__25ZKw","profile-img":"PostItem_profile-img__QQ3zR",img:"PostItem_img__1LmWv"}},35:function(e,t,n){e.exports={profile:"Profile_profile__FXFUc",posts:"Profile_posts__3qmYt","posts-section":"Profile_posts-section__UtMJ2"}},39:function(e,t,n){e.exports={navbar:"MainNavigation_navbar__Hp_AV"}},40:function(e,t,n){e.exports={title:"GeneralPosts_title__uhP4V",posts:"GeneralPosts_posts__mFaeW",message:"GeneralPosts_message__LttGU"}},41:function(e,t,n){e.exports={"new-post":"NewPost_new-post__mFH1c","edit-img":"NewPost_edit-img___W7Vw",actions:"NewPost_actions__1-6wI"}},52:function(e,t,n){e.exports={posts:"PostsList_posts__QC7PH"}},58:function(e,t,n){},69:function(e,t,n){"use strict";n.r(t);var c,a=n(7),r=n.n(a),s=n(48),i=n.n(s),o=(n(58),n(12)),u=n(27),l=Object(a.createContext)({isLoggedIn:!1,userId:"",username:"",profilePicture:"",createNewUser:function(e,t){},login:function(e,t){},logout:function(){}}),j=n(39),b=n.n(j),d=n(6),f=function(){var e=Object(a.useContext)(l);return e.isLoggedIn?Object(d.jsxs)("nav",{className:b.a.navbar,children:[Object(d.jsxs)("div",{children:[Object(d.jsx)(u.b,{to:"/general",children:"Home"}),Object(d.jsx)(u.b,{to:"/profile",children:"Profile"})]}),Object(d.jsx)("button",{className:"btn ".concat(b.a.btn),onClick:function(){e.logout()},children:"Logout"})]}):Object(d.jsx)("nav",{className:b.a.navbar,children:Object(d.jsx)(u.b,{to:"/auth",children:Object(d.jsx)("button",{className:"btn",children:"Login"})})})},p=n(11),h=function(e){var t=Object(a.useState)(""),n=Object(p.a)(t,2),c=n[0],r=n[1],s=Object(a.useState)(!1),i=Object(p.a)(s,2),o=i[0],u=i[1],l=e(c);return{value:c,isValid:l,hasError:o&&!l,valueChangeHandler:function(e){r(e.target.value)},inputBlurHandler:function(){u(!0)}}},O=n(24),m=n.n(O),g=function(){var e=Object(a.useState)(!0),t=Object(p.a)(e,2),n=t[0],c=t[1],r=Object(a.useContext)(l),s=h((function(e){return e.includes("@")})),i=s.value,o=s.isValid,j=s.hasError,b=s.valueChangeHandler,f=s.inputBlurHandler,O=h((function(e){return e.trim().length>=6})),g=O.value,x=O.isValid,v=O.hasError,_=O.valueChangeHandler,k=O.inputBlurHandler,w=h((function(e){return e.trim().length>=4})),N=w.value,I=w.isValid,P=w.hasError,C=w.valueChangeHandler,y=w.inputBlurHandler,S=function(e){return"".concat(m.a.message," ").concat(e?m.a.red:"")},L=n?"current-password":"new-password";return Object(d.jsxs)("div",{className:m.a["form-container"],children:[Object(d.jsx)("h1",{children:"Posts Demo"}),Object(d.jsxs)("form",{onSubmit:function(e){if(e.preventDefault(),!o||!x)return f(),k(),void(n||I||y());n?r.login(i,g):r.createNewUser(i,g,N)},children:[Object(d.jsx)("input",{type:"text",placeholder:"Email",value:i,onChange:b,onBlur:f,autoComplete:"email",className:j?m.a.error:""}),j&&Object(d.jsx)("span",{className:S(j),children:"Invalid email"}),Object(d.jsx)("input",{type:"password",placeholder:"Password",value:g,onChange:_,onBlur:k,autoComplete:L,className:v?m.a.error:""}),(!n||v)&&Object(d.jsx)("span",{className:S(v),children:"6 characters or more"}),!n&&Object(d.jsxs)("div",{className:m.a["user-info"],children:[Object(d.jsx)("input",{type:"text",placeholder:"Username",value:N,onChange:C,onBlur:y,className:P?m.a.error:""}),Object(d.jsx)("span",{className:S(P),children:"4 characters or more"})]}),Object(d.jsx)("button",{className:"btn ".concat(m.a.btn),type:"submit",children:n?"Log in":"Sign up"})]}),Object(d.jsxs)("div",{className:m.a.actions,children:[Object(d.jsx)("span",{onClick:function(){c((function(e){return!e}))},className:m.a.text,children:n?"Don't have an account? Register!":"Login with existing account"}),Object(d.jsx)(u.b,{to:"general",children:"Enter as guest"})]})]})},x=n(40),v=n.n(x),_=n(31),k=n(17),w=n(0),N=n.n(w),I=n(1),P=n(14),C=n(25),y=n(51),S=Object(y.a)({apiKey:"AIzaSyC7BCm-0dBGHvPJPd7By8dD99WwXerbPbs",authDomain:"social-project-f4800.firebaseapp.com",projectId:"social-project-f4800",storageBucket:"social-project-f4800.appspot.com",messagingSenderId:"903970892258",appId:"1:903970892258:web:81b7d4987b8acf5c0131bb"}),L=Object(P.g)(S),F=Object(C.c)(S),E=function(){var e=Object(I.a)(N.a.mark((function e(t,n){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(P.a)(Object(P.b)(L,t),n);case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),H=function(){var e=Object(I.a)(N.a.mark((function e(t,n){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(P.k)(Object(P.e)(L,t),n);case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),U=function(){var e=Object(I.a)(N.a.mark((function e(t,n,c,a,r){var s;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s={text:n},(!1===c||c&&a)&&(s={text:n,image:c||null,image_local:r||null},A(a)),c&&!a&&(s={text:n,image:c,image_local:r}),e.next=5,Object(P.k)(Object(P.e)(L,t),s);case 5:case"end":return e.stop()}}),e)})));return function(t,n,c,a,r){return e.apply(this,arguments)}}(),B=function(){var e=Object(I.a)(N.a.mark((function e(t,n){var c;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=Object(C.d)(F,t),e.next=3,Object(C.e)(c,n);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),A=function(e){var t=Object(C.d)(F,e);Object(C.a)(t)},R=function(){var e=Object(I.a)(N.a.mark((function e(t,n){var c;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(C.b)(Object(C.d)(F,t));case 2:c=e.sent,n(c);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),D=function(){var e=Object(I.a)(N.a.mark((function e(t){var n;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(P.f)(Object(P.e)(L,"users",t));case 2:return n=e.sent,e.abrupt("return",n.data());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),G=n.p+"static/media/trash.bb8494aa.svg",V=n.p+"static/media/heart-empty.94cfda63.svg",z=n.p+"static/media/heart-full.cb0d2295.svg",W=n.p+"static/media/profile-user.2ab6e483.svg",Q=n(32),Y=n.n(Q),J=function(e){var t=e.data,n=e.onEdit,c=e.isPrivate,r=Object(a.useContext)(l),s=t.text,i=t.id,u=t.image,j=t.image_local,b=t.likes,f=t.author_id,p=t.author,h=t.timestamp,O=t.author_photo,m=r.userId,g=t.likes.users.includes(m),x="/general"===Object(o.h)().pathname;return Object(d.jsxs)("li",{className:Y.a.post,children:[Object(d.jsxs)("div",{children:[x&&Object(d.jsxs)("div",{className:Y.a["user-info"],children:[Object(d.jsx)("div",{className:Y.a["profile-img"],children:Object(d.jsx)("img",{className:Y.a.img,src:O||W,alt:"profile"})}),Object(d.jsxs)("span",{children:[p," \xa0"]})]}),Object(d.jsx)("span",{children:new Date(h).toLocaleString()}),!x&&Object(d.jsxs)("div",{className:Y.a.actions,children:[Object(d.jsx)("button",{onClick:function(){n({text:s,id:i,image:u,isPrivate:c,image_local:j})},children:"edit"}),Object(d.jsx)("img",{onClick:function(){var e,t=c?"private-posts":"posts";e="users/".concat(m,"/").concat(t,"/").concat(i),Object(P.d)(Object(P.e)(L,e)),u&&A(j)},src:G,alt:"trash-icon"})]})]}),Object(d.jsxs)("div",{children:[u&&Object(d.jsx)("img",{id:"post-image",src:u,alt:"post"}),Object(d.jsx)("span",{children:s})]}),!c&&Object(d.jsxs)("div",{children:[Object(d.jsx)("img",{onClick:function(){if(r.isLoggedIn){var e=g?null:"like";!function(e,t,n,c,a){if(("like"!==a||!c.includes(t))&&(a||c.includes(t))){var r=Object(k.a)(c);"like"===a?r.push(t):r=r.filter((function(e){return e!==t}));var s={likes:{counter:"like"===a?n+1:n-1,users:r}};Object(P.k)(Object(P.e)(L,e),s)}}("users/".concat(f,"/posts/").concat(i),m,b.counter,b.users,e)}},src:g?z:V,alt:"empty-heart-icon"}),Object(d.jsxs)("span",{children:[b.counter," likes"]})]})]})},M=n(52),X=n.n(M),q=function(e){var t=Object(a.useState)([]),n=Object(p.a)(t,2),c=n[0],r=n[1],s=Object(a.useState)(!0),i=Object(p.a)(s,2),o=i[0],u=i[1],l=e.isCollectionGroup,j=e.collPath,b=e.onEdit,f=e.isPrivate;Object(a.useEffect)((function(){var e;return e=l?Object(P.i)(Object(P.c)(L,j)):Object(P.i)(Object(P.b)(L,j)),Object(P.h)(e,(function(e){var t=[];e.forEach((function(e){return t.push(Object(_.a)(Object(_.a)({},e.data()),{},{id:e.id}))})),r(t),u(!1)}))}),[j,l]);var h=c.sort((function(e,t){return t.timestamp-e.timestamp}));return Object(d.jsxs)("div",{className:X.a.posts,children:[o&&Object(d.jsx)("p",{children:"Loading"}),!o&&0===c.length&&Object(d.jsx)("p",{children:"No posts found"}),!o&&0!==c.length&&Object(d.jsx)("ul",{children:h.map((function(e){return Object(d.jsx)(J,{data:e,onEdit:b,isPrivate:f},e.id)}))})]})},K=function(e){return Object(d.jsxs)(a.Fragment,{children:[!e.isLoggedIn&&Object(d.jsx)("div",{className:v.a.message,children:"You are currently visualizing other people posts as a guest. Please login to be able to like them and make your own"}),Object(d.jsx)("h1",{className:v.a.title,children:"General Posts"}),Object(d.jsx)("div",{className:v.a.posts,children:Object(d.jsx)(q,{isCollectionGroup:!0,collPath:"posts"})})]})},T=n.p+"static/media/gear.02b5bbbc.svg",Z=n(28),$=n.n(Z),ee=null,te=function(){var e=Object(a.useContext)(l),t=Object(a.useState)(!1),n=Object(p.a)(t,2),r=n[0],s=n[1],i=Object(a.useState)(null),o=Object(p.a)(i,2),u=o[0],j=o[1],b=Object(a.useState)(!1),f=Object(p.a)(b,2),h=f[0],O=f[1],m=Object(a.useState)(!1),g=Object(p.a)(m,2),x=g[0],v=g[1],_=e.profilePicture;Object(a.useEffect)((function(){return _?(j(_),c=_):(j(W),c=W),ee=null}),[_]);var k=function(){var t=Object(I.a)(N.a.mark((function t(){var n;return N.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return O(!0),t.next=3,B("users/".concat(e.userId,"/profile-image"),ee);case 3:return t.next=5,R("users/".concat(e.userId,"/profile-image"),(function(e){n=e}));case 5:return t.next=7,H("users/".concat(e.userId),{photo:n});case 7:ee=null,e.pictureChange(n),s(!1),O(!1),v(!0),setTimeout((function(){return v(!1)}),3e3);case 13:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),w=h?"btn disabled":"btn";return Object(d.jsxs)("div",{className:$.a.info,children:[Object(d.jsx)("img",{onClick:function(){return s((function(e){return!e}))},className:$.a["config-icon"],src:T,alt:"configurate"}),u&&Object(d.jsx)("img",{src:u,className:$.a["profile-img"],alt:"profile"}),Object(d.jsx)("h3",{children:e.username}),x&&Object(d.jsx)("span",{className:$.a.message,children:"Your profile picture has been changed, you might need to refresh the page to visualize this change"}),r&&Object(d.jsxs)("div",{className:$.a.config,children:[Object(d.jsx)("input",{type:"file",onChange:function(e){if(e.target.files&&e.target.files[0]){ee=e.target.files[0];var t=new FileReader;t.onload=function(e){j(e.target.result)},t.readAsDataURL(e.target.files[0])}else ee=null,j(c)},accept:"image/*",id:"file-input"}),Object(d.jsx)("button",{className:w,onClick:function(){document.getElementById("file-input").click()},disabled:h,children:"change profile picture"}),ee&&Object(d.jsxs)("div",{className:$.a["action-btns"],children:[Object(d.jsx)("button",{className:w,onClick:k,disabled:h,children:"Confirm"}),Object(d.jsx)("button",{className:w,onClick:function(){ee=null,j(c),s(!1)},disabled:h,children:"Cancel"})]})]})]})},ne=n(41),ce=n.n(ne),ae=function(e){var t=e.edit,n=e.onFinishEditing,c=Object(a.useState)(null),r=Object(p.a)(c,2),s=r[0],i=r[1],o=Object(a.useState)(null),u=Object(p.a)(o,2),j=u[0],b=u[1],f=Object(a.useState)(!1),h=Object(p.a)(f,2),O=h[0],m=h[1];console.log("new post executed"),Object(a.useEffect)((function(){console.log("effect working"),t&&t.image&&i(t.image),t||i(null),b(null)}),[t]);var g=Object(a.useContext)(l),x=Object(a.useRef)(),v=Object(a.useRef)();t&&(x.current.value=t.text);var _=function(){var e=Object(I.a)(N.a.mark((function e(c){var a,r,i,o,u;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==(a=x.current.value).trim().length){e.next=4;break}return alert("Post must not be empty"),e.abrupt("return");case 4:if(m(!0),r="posts",j&&(i="users/".concat(g.userId,"/").concat(r,"/").concat(j.name)),!t){e.next=19;break}if(t.isPrivate&&(r="private-posts"),!j){e.next=14;break}return e.next=12,B(i,j);case 12:return e.next=14,R(i,(function(e){return o=e}));case 14:return e.next=16,U("users/".concat(g.userId,"/").concat(r,"/").concat(t.id),a,s?j?o:null:s,t.image_local,i);case 16:n(),e.next=28;break;case 19:if(!0===c&&(r="private-posts"),!j){e.next=26;break}return console.log("file uploaded"),e.next=24,B(i,j);case 24:return e.next=26,R(i,(function(e){return u=e}));case 26:return e.next=28,E("users/".concat(g.userId,"/").concat(r),{text:a,timestamp:(new Date).getTime(),author:g.username,likes:{counter:0,users:[]},author_id:g.userId,author_photo:g.profilePicture?g.profilePicture:null,image:j?u:null,image_local:i||null});case 28:k(),m(!1);case 30:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=Object(I.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:b(null),i(null),v.current.value=null,t||(x.current.value="");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),w=O?"btn disabled":"btn";return Object(d.jsxs)("div",{className:ce.a["new-post"],children:[s&&Object(d.jsxs)("div",{className:ce.a["edit-img"],children:[Object(d.jsx)("img",{src:s,alt:"post"}),Object(d.jsx)("button",{onClick:function(){t?i(!1):k(!0)},children:"Remove image"})]}),Object(d.jsx)("textarea",{placeholder:"What do you want to share?",ref:x}),Object(d.jsxs)("div",{className:ce.a.actions,children:[Object(d.jsx)("input",{ref:v,type:"file",accept:"image/*",onChange:function(e){var t=e.target.files[0];if(e.target.files&&t){var n=new FileReader;n.onload=function(e){i(e.target.result),b(t)},n.readAsDataURL(e.target.files[0])}else k(!0)}}),Object(d.jsxs)("div",{children:[Object(d.jsx)("button",{className:w,onClick:_,disabled:O,children:t?"Confirm edit":"Share"}),!t&&Object(d.jsx)("button",{className:w,onClick:_.bind(null,!0),disabled:O,children:"Save as private"}),t&&Object(d.jsx)("button",{className:w,onClick:function(){n(),x.current.value=""},disabled:O,children:"Cancel"})]})]}),O&&Object(d.jsx)("span",{children:"Saving..."})]})},re=n.p+"static/media/down-arrow.474a217e.svg",se=n(35),ie=n.n(se),oe=function(){var e=Object(a.useState)(null),t=Object(p.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)(!0),s=Object(p.a)(r,2),i=s[0],o=s[1],u=Object(a.useState)(!1),j=Object(p.a)(u,2),b=j[0],f=j[1],h=Object(a.useContext)(l),O=function(e){return c(e)};return Object(d.jsxs)("div",{className:ie.a.profile,children:[Object(d.jsx)(te,{}),Object(d.jsxs)("div",{className:ie.a.posts,children:[Object(d.jsx)(ae,{edit:n,onFinishEditing:function(){return c(null)}}),Object(d.jsxs)("section",{className:ie.a["posts-section"],children:[Object(d.jsx)("img",{src:re,onClick:function(){return o((function(e){return!e}))},style:{transform:i?"rotate(-90deg)":""},alt:"arrow-icon"}),Object(d.jsx)("h2",{children:"Public posts"}),i&&Object(d.jsx)(q,{collPath:"users/".concat(h.userId,"/posts"),userId:h.userId,onEdit:O,isPrivate:!1})]}),Object(d.jsxs)("section",{className:ie.a["posts-section"],children:[Object(d.jsx)("img",{src:re,onClick:function(){return f((function(e){return!e}))},style:{transform:b?"rotate(-90deg)":""},alt:"arrow-icon"}),Object(d.jsx)("h2",{children:"Private posts"}),b&&Object(d.jsx)(q,{collPath:"users/".concat(h.userId,"/private-posts"),onEdit:O,isPrivate:!0})]})]})]})},ue=n.p+"static/media/background.a22d7c02.jpg";var le=function(){var e=Object(a.useContext)(l),t=Object(o.h)();return Object(d.jsxs)(a.Fragment,{children:["/auth"!==t.pathname&&Object(d.jsx)(f,{}),Object(d.jsx)("img",{className:"background",src:ue,alt:"background"}),Object(d.jsxs)(o.d,{children:[Object(d.jsx)(o.b,{path:"/",exact:!0,children:Object(d.jsx)(o.a,{to:"/auth"})}),Object(d.jsxs)(o.b,{path:"/auth",children:[!e.isLoggedIn&&Object(d.jsx)(g,{}),e.isLoggedIn&&Object(d.jsx)(o.a,{to:"/profile"})]}),e.isLoggedIn&&Object(d.jsx)(o.b,{path:"/profile",children:Object(d.jsx)(oe,{})}),Object(d.jsx)(o.b,{path:"/general",children:Object(d.jsx)(K,{isLoggedIn:e.isLoggedIn})}),Object(d.jsx)(o.b,{path:"*",children:Object(d.jsx)(o.a,{to:"/auth"})})]})]})},je=n(36),be={isLoggedIn:!1,id:"",username:null},de=function(e){var t=Object(a.useState)(be),n=Object(p.a)(t,2),c=n[0],r=n[1],s=Object(o.g)(),i=Object(je.b)();Object(a.useEffect)((function(){Object(je.c)(i,(function(e){e&&function(){var t=Object(I.a)(N.a.mark((function t(){var n;return N.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,D(e.uid);case 2:n=t.sent,r({isLoggedIn:!0,id:e.uid,username:n.username,profilePicture:n.photo});case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()()}))}),[i]);var u={isLoggedIn:c.isLoggedIn,userId:c.id,username:c.username,profilePicture:c.profilePicture,createNewUser:function(e,t,n){Object(je.a)(i,e,t).then((function(e){return r({isLoggedIn:!0,id:e.user.uid}),e.user.uid})).then((function(t){return Object(P.j)(Object(P.e)(L,"users",t),{username:n,email:e})})).then((function(){alert("You have succesfully created an account"),s.push("/profile")})).catch((function(e){alert(e.code)}))},login:function(e,t){Object(je.d)(i,e,t).then((function(e){r({isLoggedIn:!0,id:e.user.uid})})).then((function(){s.push("/profile")})).catch((function(e){alert(e.code)}))},logout:function(){i.signOut(),r(be)},pictureChange:function(e){r((function(t){return Object(_.a)(Object(_.a)({},t),{},{profilePicture:e})}))}};return Object(d.jsx)(l.Provider,{value:u,children:e.children})};i.a.render(Object(d.jsx)(r.a.StrictMode,{children:Object(d.jsx)(u.a,{basename:"/Social-Network",children:Object(d.jsx)(de,{children:Object(d.jsx)(le,{})})})}),document.getElementById("root"))}},[[69,1,2]]]);
//# sourceMappingURL=main.b882aaac.chunk.js.map